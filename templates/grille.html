<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Generator</title>
    <script>
        async function submitForm(event) {
            event.preventDefault();
            const number = document.getElementById("number").value;

            const response = await fetch("/generate", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({ number: number }),
            });

            const result = await response.json();

            if (response.ok) {
                // Met a jour l'image
                document.getElementById("output-image").src = result.image_url + '?' + new Date().getTime();
            } else {
                alert(result.error || "Une erreur a eu lieu");
            }
        }
    </script>
</head>
<body>
    <form onsubmit="submitForm(event)">
        <label for="number">Entre le numéro de la partie:</label>
        <input type="number" id="number" name="number" required>
        <button type="submit">Generée l'image</button>
    </form>
    <div>
        <h2>Image generée:</h2>
        <style>
            body {
                display: flex;
                justify-content: center;
                align-items: center;
                height: 100vh;
                margin: 0;
            }
            #output-image {
                position: fixed;
                top: 100px;     /* Positionner à 100px du haut du conteneur */
                left: 100px;
            }
        </style>
        <img id="output-image" src="" alt="Image" height=800 width=800>
        <!-- la position de la grille est : X = 10 et Y = 10 et 760 de hauteur avec 20 cases-->
    </div>
</body>
</html>

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Déplacer une image</title>
    <style>
        /* Conteneur de l'image */
        #pos {
            position: absolute;
            z-index: 9;
            background-color: transparent;
            text-align: center;
            border: none;  /* Assurez-vous qu'il n'y a pas de bordure */
            top: 20px;     /* Positionner à 100px du haut du conteneur */
            left: 1000px;
        }

        /* Zone de déplacement */
        #posi {
            cursor: move;
            z-index: 10;
            background-color: transparent;
            color: transparent;
            
        }

        /* Supprimer la bordure de l'image */
        #posi img {
            border: none;  /* Supprimer toute bordure autour de l'image */
            display: block; /* Pour éviter l'espacement au-dessous de l'image */
            max-width: 100%; /* Optionnel, ajuste la taille de l'image pour qu'elle soit responsive */
        }
    </style>
</head>
<body>

<!-- Conteneur = pos et sous-conteneur = posi -->
<div id="pos">
   <div id="posi"><img src="../static/piece/R/1.png" alt="Piece" height=200 width=200></div>
</div>

<!-- Donne les coordonnées de la pièce choisie juste avant -->
<p>Position de l'image : <span id="coords">X: 0, Y: 0</span></p>

<script>
    // Lance la fonction getElementById avec l'image
    glisseElement(document.getElementById("pos"));

    function glisseElement(element) {
        var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;

        // Quand la souris sélectionne l'image, on lance une nouvelle fonction
        element.querySelector("#posi").onmousedown = glisseSourisAppuie;

        function glisseSourisAppuie(e) {
            // Empêche le comportement par défaut du navigateur
            e.preventDefault();
            // Capturer la position de la souris au moment du clic
            pos3 = e.clientX;
            pos4 = e.clientY;
            // Attacher les événements pour déplacer l'élément
            document.onmouseup = arreteGlisseElement;
            document.onmousemove = elementGlisse;
        }

        function elementGlisse(e) {
            e.preventDefault();
            // Calculer la nouvelle position de l'élément
            pos1 = pos3 - e.clientX;
            pos2 = pos4 - e.clientY;
            pos3 = e.clientX;
            pos4 = e.clientY;
            // Déplacer l'élément, element.offset... donne la position entre le parent et l'élément, ... = met à jour les données
            element.style.top = (element.offsetTop - pos2) + "px";
            element.style.left = (element.offsetLeft - pos1) + "px";
            // Met à jour les coordonnées
            updateCoords();
        }

        function arreteGlisseElement() {
            // Arrête le déplacement lorsque la souris est relâchée
            document.onmouseup = null;
            document.onmousemove = null;
        }
        // Affiche les coordonnées actuelles
        function updateCoords() {
            // Récupère la position de l'élément
            var pos = element.getBoundingClientRect();
            // Chaîne de texte
            var coordsText = "X: " + Math.round(pos.left) + ", Y: " + Math.round(pos.top);
            // Met à jour
            document.getElementById("coords").textContent = coordsText;
        }
    }
</script>

</body>
</html>

