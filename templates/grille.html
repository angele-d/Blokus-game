<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Generator</title>
    <script>
        async function submitForm(event) {
            event.preventDefault();
            const number = document.getElementById("number").value;

            const response = await fetch("/generate", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({ number: number }),
            });

            const result = await response.json();

            if (response.ok) {
                // Met a jour l'image
                document.getElementById("output-image").src = result.image_url + '?' + new Date().getTime();
            } else {
                alert(result.error || "Une erreur a eu lieu");
            }
        }
    </script>
</head>
<body>
    <h1>Genere la grille</h1>
    <form onsubmit="submitForm(event)">
        <label for="number">Entre le numéro de la partie:</label>
        <input type="number" id="number" name="number" required>
        <button type="submit">Generée l'image</button>
    </form>
    <div>
        <h2>Image generée:</h2>
        <style>
            body {
                display: flex;
                justify-content: center;
                align-items: center;
                height: 100vh;
                margin: 0;
            }
        </style>
        <img id="output-image" src="" alt="Image" style="max-width: 100%; height: auto; border: 1px solid #ccc;" height=800 width=800>
    </div>
</body>

<!DOCTYPE html>
<style>
#pos {
  position: absolute;
  z-index: 9;
  background-color: #f1f1f1;
  text-align: center;
  border: 1px solid #d3d3d3;
}

#posi {
  padding: 10px;
  cursor: move;
  z-index: 10;
  background-color: #2196F3;
  color: #fff;
}
</style>
<body>

<p>Déplacez la pièce choisie à l'endroit souhaité</p>

<div id="pos">
   <div id="posi"><img src = BlokusTiles.svg></img></div>
</div>

<script>
glisseElement(document.getElementById("pos"));

function glisseElement(element) {
  var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
  if (document.getElementById(element.id + "header")) {
    document.getElementById(element.id + "header").onmousedown = glisseMouseDown;
  } else {
    element.onmousedown = glisseMouseDown;
  }

  function glisseMouseDown(e) {
    e = e || window.event;
    e.preventDefault();
    pos3 = e.clientX;
    pos4 = e.clientY;
    document.onmouseup = closeGlisseElement;
    document.onmousemove = elementGlisse;
  }

  function elementGlisse(e) {
    e = e || window.event;
    e.preventDefault();
    pos1 = pos3 - e.clientX;
    pos2 = pos4 - e.clientY;
    pos3 = e.clientX;
    pos4 = e.clientY;
    element.style.top = (element.offsetTop - pos2) + "px";
    element.style.left = (element.offsetLeft - pos1) + "px";
  }

  function closeGlisseElement() {
    document.onmouseup = null;
    document.onmousemove = null;
  }
}
</script>

</body>

</html>
